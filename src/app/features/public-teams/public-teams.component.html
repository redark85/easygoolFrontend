<div class="teams-container">
  

  <!-- Page Header -->
  <div class="page-header">
    <!-- Back Button -->
  <button mat-icon-button class="back-button" (click)="goBack()">
    <mat-icon>arrow_back</mat-icon>
  </button>
    <div class="header-content">
    <mat-icon class="header-icon">groups</mat-icon>
    <div class="header-text">
      <h1 class="page-title">Equipos Participantes</h1>
      <p class="page-subtitle">Todos los equipos del torneo</p>
    </div>
    </div>
  </div>

  <!-- Stats Cards -->
  <div class="stats-grid">
    <mat-card class="stat-card">
      <mat-card-content>
        <mat-icon class="stat-icon teams">shield</mat-icon>
        <div class="stat-info">
          <span class="stat-value">{{ stats.totalTeams }}</span>
          <span class="stat-label">Equipos</span>
        </div>
      </mat-card-content>
    </mat-card>

    <mat-card class="stat-card">
      <mat-card-content>
        <mat-icon class="stat-icon players">people</mat-icon>
        <div class="stat-info">
          <span class="stat-value">{{ stats.totalPlayers }}</span>
          <span class="stat-label">Jugadores</span>
        </div>
      </mat-card-content>
    </mat-card>

    <mat-card class="stat-card">
      <mat-card-content>
        <mat-icon class="stat-icon goals">sports_soccer</mat-icon>
        <div class="stat-info">
          <span class="stat-value">{{ stats.totalGoals }}</span>
          <span class="stat-label">Goles Totales</span>
        </div>
      </mat-card-content>
    </mat-card>

    <mat-card class="stat-card">
      <mat-card-content>
        <mat-icon class="stat-icon average">trending_up</mat-icon>
        <div class="stat-info">
          <span class="stat-value">{{ stats.averageGoals | number:'1.1-1' }}</span>
          <span class="stat-label">Prom. Goles</span>
        </div>
      </mat-card-content>
    </mat-card>
  </div>

  <!-- Filters Card -->
  <mat-card class="filters-card">
    <mat-card-content>
      <div class="filters-container">
        <!-- Search -->
        <mat-form-field appearance="outline" class="search-field">
          <mat-label>Buscar equipo</mat-label>
          <input matInput 
                 [(ngModel)]="searchText" 
                 (ngModelChange)="onSearchChange()"
                 placeholder="Nombre, entrenador, estadio...">
          <mat-icon matPrefix>search</mat-icon>
          <button mat-icon-button matSuffix *ngIf="searchText" (click)="searchText = ''; onSearchChange()">
            <mat-icon>close</mat-icon>
          </button>
        </mat-form-field>

        <!-- Group Filter -->
        <mat-form-field appearance="outline" class="filter-field">
          <mat-label>Grupo</mat-label>
          <mat-select [(ngModel)]="selectedGroupId" (selectionChange)="onGroupChange()">
            <mat-option [value]="null">Todos los grupos</mat-option>
            <mat-option *ngFor="let group of groups" [value]="group.id">
              <mat-icon class="option-icon">flag</mat-icon>
              {{ group.name }}
            </mat-option>
          </mat-select>
        </mat-form-field>

        <!-- Position Filter -->
        <mat-form-field appearance="outline" class="filter-field">
          <mat-label>Posición en Tabla</mat-label>
          <mat-select [(ngModel)]="selectedPositionFilter" (selectionChange)="onPositionChange()">
            <mat-option *ngFor="let filter of positionFilters" [value]="filter.id">
              <mat-icon class="option-icon">emoji_events</mat-icon>
              {{ filter.name }}
            </mat-option>
          </mat-select>
        </mat-form-field>

        <!-- Clear Filters Button -->
        <button mat-raised-button 
                color="accent" 
                (click)="clearFilters()"
                *ngIf="selectedGroupId || selectedPositionFilter !== 'all' || searchText">
          <mat-icon>clear_all</mat-icon>
          Limpiar Filtros
        </button>
      </div>

      <!-- Active Filters Chips -->
      <div class="active-filters" *ngIf="selectedGroupId || selectedPositionFilter !== 'all' || searchText">
        <span class="filters-label">Filtros activos:</span>
        <div class="chips-container">
          <mat-chip *ngIf="searchText" (click)="searchText = ''; onSearchChange()">
            Búsqueda: "{{ searchText }}"
            <mat-icon matChipRemove>cancel</mat-icon>
          </mat-chip>
          <mat-chip *ngIf="selectedGroupId" (click)="selectedGroupId = null; onGroupChange()">
            {{ getSelectedGroupName() }}
            <mat-icon matChipRemove>cancel</mat-icon>
          </mat-chip>
          <mat-chip *ngIf="selectedPositionFilter !== 'all'" (click)="selectedPositionFilter = 'all'; onPositionChange()">
            {{ getSelectedPositionFilterName() }}
            <mat-icon matChipRemove>cancel</mat-icon>
          </mat-chip>
        </div>
      </div>
    </mat-card-content>
  </mat-card>

  <!-- Loading State -->
  <div class="loading-container" *ngIf="isLoading">
    <mat-spinner diameter="50"></mat-spinner>
    <p class="loading-text">Cargando equipos...</p>
  </div>

  <!-- Teams Grid -->
  <div class="teams-grid" *ngIf="!isLoading && filteredTeams.length > 0">
    <mat-card *ngFor="let team of filteredTeams" 
              class="team-card" 
              [ngClass]="getPositionClass(team.position)"
              (click)="viewTeam(team)">
      
      <!-- Position Badge -->
      <div class="position-badge" [ngClass]="getPositionClass(team.position)">
        <mat-icon *ngIf="team.position <= 3">emoji_events</mat-icon>
        <span>{{ team.position }}°</span>
      </div>

      <!-- Team Logo -->
      <div class="team-logo-container">
        <img [src]="team.logoUrl" [alt]="team.name" class="team-logo">
      </div>

      <!-- Team Name -->
      <h3 class="team-name">{{ team.name }}</h3>
      <p class="team-short-name">{{ team.shortName }}</p>

      <!-- Group Badge -->
      <div class="group-badge">
        <mat-icon>flag</mat-icon>
        <span>{{ team.groupName }}</span>
      </div>

      <!-- Team Stats -->
      <div class="team-stats">
        <div class="stat">
          <span class="value">{{ team.points }}</span>
          <span class="label">Puntos</span>
        </div>
        <div class="stat">
          <span class="value">{{ team.totalPlayers }}</span>
          <span class="label">Jugadores</span>
        </div>
        <div class="stat">
          <span class="value" [style.color]="getGoalDifferenceColor(team.goalDifference)">
            {{ team.goalDifference > 0 ? '+' : '' }}{{ team.goalDifference }}
          </span>
          <span class="label">Dif. Goles</span>
        </div>
      </div>

      <!-- Additional Info -->
      <div class="team-info">
        <div class="info-item">
          <mat-icon>person</mat-icon>
          <span>{{ team.coach }}</span>
        </div>
        <div class="info-item">
          <mat-icon>stadium</mat-icon>
          <span>{{ team.stadium }}</span>
        </div>
        <div class="info-item">
          <mat-icon>calendar_today</mat-icon>
          <span>Fundado: {{ team.founded }}</span>
        </div>
      </div>

      <!-- Record -->
      <div class="team-record">
        <div class="record-item wins">
          <span class="count">{{ team.wins }}</span>
          <span class="label">V</span>
        </div>
        <div class="record-item draws">
          <span class="count">{{ team.draws }}</span>
          <span class="label">E</span>
        </div>
        <div class="record-item losses">
          <span class="count">{{ team.losses }}</span>
          <span class="label">D</span>
        </div>
      </div>

      <!-- View Details Button -->
      <button mat-button color="primary" class="view-details-btn">
        <mat-icon>visibility</mat-icon>
        Ver Detalles
      </button>
    </mat-card>
  </div>

  <!-- Empty State -->
  <div class="empty-state" *ngIf="!isLoading && filteredTeams.length === 0">
    <mat-icon class="empty-icon">search_off</mat-icon>
    <h2>No se encontraron equipos</h2>
    <p>No hay equipos que coincidan con los filtros seleccionados</p>
    <button mat-raised-button color="primary" (click)="clearFilters()">
      Limpiar Filtros
    </button>
  </div>

  <!-- Results Count -->
  <div class="results-count" *ngIf="!isLoading && filteredTeams.length > 0">
    <p>Mostrando {{ filteredTeams.length }} de {{ teams.length }} equipos</p>
  </div>
</div>
