<div class="modal-container">
  <div class="modal-header">
    <h2 mat-dialog-title>
      <mat-icon class="title-icon">verified_user</mat-icon>
      Verificación de Cuenta
    </h2>
  </div>

  <div class="modal-content" mat-dialog-content>
    <div class="verification-info">
      <p class="info-text">
        Hemos enviado un código de verificación de 6 dígitos a:
      </p>
      <p class="email-display">
        <mat-icon>email</mat-icon>
        {{ data.email }}
      </p>
      <p class="info-subtext">
        Por favor, ingresa el código para completar tu registro.
      </p>
    </div>

    <form [formGroup]="otpForm" class="otp-form">
      <div class="otp-inputs" (paste)="onPaste($event)">
        <input
          type="text"
          id="digit1"
          formControlName="digit1"
          maxlength="1"
          class="otp-input"
          (input)="onDigitInput($event, 1)"
          (keydown)="onDigitKeyDown($event, 1)"
          autocomplete="off"
        />
        <input
          type="text"
          id="digit2"
          formControlName="digit2"
          maxlength="1"
          class="otp-input"
          (input)="onDigitInput($event, 2)"
          (keydown)="onDigitKeyDown($event, 2)"
          autocomplete="off"
        />
        <input
          type="text"
          id="digit3"
          formControlName="digit3"
          maxlength="1"
          class="otp-input"
          (input)="onDigitInput($event, 3)"
          (keydown)="onDigitKeyDown($event, 3)"
          autocomplete="off"
        />
        <input
          type="text"
          id="digit4"
          formControlName="digit4"
          maxlength="1"
          class="otp-input"
          (input)="onDigitInput($event, 4)"
          (keydown)="onDigitKeyDown($event, 4)"
          autocomplete="off"
        />
        <input
          type="text"
          id="digit5"
          formControlName="digit5"
          maxlength="1"
          class="otp-input"
          (input)="onDigitInput($event, 5)"
          (keydown)="onDigitKeyDown($event, 5)"
          autocomplete="off"
        />
        <input
          type="text"
          id="digit6"
          formControlName="digit6"
          maxlength="1"
          class="otp-input"
          (input)="onDigitInput($event, 6)"
          (keydown)="onDigitKeyDown($event, 6)"
          autocomplete="off"
        />
      </div>
    </form>

    <div class="timer-section" [class.expired]="isExpired">
      <mat-icon>schedule</mat-icon>
      <span class="timer-text">
        {{ isExpired ? 'Código expirado' : 'Tiempo restante: ' + timerDisplay }}
      </span>
    </div>

    <div class="resend-section">
      <p class="resend-text">
        {{ isExpired ? '¿No recibiste el código o expiró?' : '¿No recibiste el código?' }}
      </p>
      <button mat-stroked-button color="primary" (click)="onResendCode()">
        <mat-icon>refresh</mat-icon>
        Reenviar código
      </button>
    </div>

    <div class="help-section" *ngIf="!isExpired">
      <p class="help-text">
        <mat-icon>info</mat-icon>
        Revisa tu carpeta de spam o correo no deseado si no encuentras el mensaje.
      </p>
    </div>
  </div>

  <div class="modal-actions" mat-dialog-actions>
    <button mat-stroked-button (click)="onCancel()" [disabled]="loading">
      Cancelar
    </button>
    <button 
      mat-flat-button 
      color="primary" 
      (click)="onVerify()" 
      [disabled]="!canVerify || loading"
    >
      <span class="button-content" *ngIf="!loading">
        <mat-icon>check_circle</mat-icon>
        Verificar
      </span>
      <span class="button-content" *ngIf="loading">
        <mat-progress-spinner diameter="20" mode="indeterminate"></mat-progress-spinner>
        Verificando...
      </span>
    </button>
  </div>
</div>
